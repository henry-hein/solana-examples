import WertWidget from '@wert-io/widget-initializer';
import type { Options } from '@wert-io/widget-initializer/types';
import { signSmartContractData } from '@wert-io/widget-sc-signer';
import { v4 as uuidv4 } from 'uuid';

import { Buffer } from 'buffer/';

window.Buffer = Buffer; // needed to use `signSmartContractData` in browser

/* We advise you not to use the private key on the frontend
    It is used here for example only
*/
const privateKey =
  '0x57466afb5491ee372b3b30d82ef7e7a0583c9e36aef0f02435bd164fe172b1d3';

const signedData = signSmartContractData(
  {
    address: '5fQPYeJ8UXK3D7JoNAXwQdq3kB1zZfg7CvwuVA6DRLYH',
    commodity: 'sol',
    network: 'solana',
    commodity_amount: 0.01,
    sc_address: 'NuFbTQUzvUAKD4GvWh3bk2hLL7xiF9Btje1Vbg9m1FJ',
    sc_input_data:
      '7b0a20202270726f6772616d5f6964223a20224e7546625451557a7655414b44344776576833626b32684c4c377869463942746a6531566267396d31464a222c0a2020226163636f756e7473223a205b0a202020207b0a2020202020202261646472657373223a20223566515059654a3855584b3344374a6f4e415877516471336b42317a5a6667374376777556413644524c5948222c0a2020202020202269735f7369676e6572223a2066616c73652c0a2020202020202269735f7772697461626c65223a20747275650a202020207d2c0a202020207b0a2020202020202261646472657373223a202242474353617765686a6e785544636971524350667258717a4b76426569545365336d45747654464335643971222c0a2020202020202269735f7369676e6572223a20747275652c0a2020202020202269735f7772697461626c65223a20747275650a202020207d2c0a202020207b0a2020202020202261646472657373223a20223131313131313131313131313131313131313131313131313131313131313131222c0a2020202020202269735f7369676e6572223a2066616c73652c0a2020202020202269735f7772697461626c65223a2066616c73650a202020207d0a20205d2c0a20202264617461223a2022366335313465373537643962333863386533663630353062316433643633643034336439323437363564316265383238323361333163373735643538653731653734613864383539346236313963376338303936393830303030303030303030220a7d',
  },
  privateKey
);

console.log('hello')


const my_click_id = uuidv4();

const otherWidgetOptions: Options = {
  partner_id: '01JSE6XPWNW07YFYMV30EP6PF4',
  // partner_id: '01JTFJJ4V09N8JJKM1JM454S8T', // prod
  click_id: my_click_id,
  origin: 'https://sandbox.wert.io', // this option needed only for this example to work
  phone: "+12012000205",
};


const wertWidget = new WertWidget({
  ...signedData,
  ...otherWidgetOptions,
});

wertWidget.open();
